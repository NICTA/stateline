## Overview
Stateline is a framework for distributed Markov Chain Monte Carlo (MCMC) sampling written in C++11. It focuses on [parallel tempering](http://en.wikipedia.org/wiki/Parallel_tempering) methods which are highly parallelisable.

## System Support
Currently, Stateline runs on Linux-based operating systems only.

## Compiler Support
Stateline has been compiled and tested under GCC 4.8.2.

## Building
To build Stateline, you will need:
* GCC 4.8.2 or newer
* CMake 2.8 or newer

The simplest way to build Stateline running is to clone the repository and fetch the dependencies:

```bash
$ git clone https://github.com/NICTA/stateline.git
$ cd stateline && ./tools/fetch-deps
```

This will automatically download and build the necessary dependencies into `build/prereqs`. Then, to build Stateline in debug, run:

```bash
$ ./tools/configure debug
$ cd build/debug && make
```

You usually only need to configure once, so just run `make` next time you want to re-compile. Only when you make significant changes to the build procedures will you need to run `./tools/configure`. More information about building can be found [here](https://github.com/NICTA/stateline/wiki/Installation-Guide).

## Example C++ Code
This is a quick example showing the Stateline C++ API to sample from a Gaussian distribution. You can read a (link)tutorial on how to build and run this code.

## Server
```cpp
#include "stateline/server.hpp"
#include "stateline/csv.hpp"

#include <iostream>

namespace sl = stateline;

int main(int argc, char *argv[])
{
  // Use the default settings with 4 chains, sampling from 1D distribution
  auto settings = sl::StatelineSettings::fromDefault(1, 4);

  // Initialise a server on port 5555
  sl::Server server{5555, settings};
  
  std::cout << "Collecting 1000 samples from each chain" << std::endl;
  auto samples = server.step(1000);
  
  // Save the samples from each chain to a CSV file in a folder called demo-samples
  sl::saveToCSV("demo-samples", samples);

  return 0;
}
```

## Worker
```cpp
#include "stateline/worker.hpp"

double gaussianNLL(const std::string& jobType, const std::vector<double>& x)
{
  double squaredNorm = 0.0;
  for (auto i : x)
  {
    squaredNorm += i * i;
  }
  return 0.5 * squaredNorm;
}

int main(int argc, char *argv[])
{
  // Only 1 job type for this demo
  std::vector<std::string> jobTypes = { "job" };
  
  // Initialise a worker with the our likelihood function and use 4 threads.
  // Blocks until the worker is no longer needed.
  stateline::runWorker(gaussianNLL, "localhost:5555", jobTypes, 4);

  return 0;
}
```

Documentation
-------------
Documentation can be found in the
[wiki](http://github.com/NICTA/stateline/wiki), and there is automatic doxygen documentation generated by running

```bash
$ make doc
```

in a build directory. Please ensure Doxygen is installed. Finally, there are examples in the `examples` folder.

Licence
-------
Please see the LICENSE file, and COPYING and COPYING.LESSER.

Bug Reports
-----------
If you find a bug, please open an [issue](http://github.com/NICTA/stateline/issues).

Contributing 
------------
Contributions and comments are welcome. Please read our [style guide](docs/CodeGuidelines.md) before submitting a pull request.
